<!DOCTYPE html>

<html lang="en">
<head>
    <meta charset="utf-8" />
    <title></title>
</head>
<body>
    <h1>Multi Minesweeper</h1>
    <button id="btnNewGame">New Game</button>
    <button id="btnStartGame">Start Game</button>
    <div id="divGameBoard"></div>
    <div id="gamesListWrapper">
        <ul id="gamesList">

        </ul>
    </div>


    <script>
        let clientId = null;
        let gameId = null;

        let ws = new WebSocket("ws://localhost:8118")
        const btnNewGame = document.getElementById("btnNewGame");
        const btnStartGame = document.getElementById("btnStartGame");
        const divGameBoard = document.getElementById("divGameBoard");
        const testText = document.getElementById("testText");
        var gameList = document.getElementById("gamesList");


        btnNewGame.addEventListener("click", e => {

            if (true) {
                const payLoad = {
                    "method": "newGame",
                    "clientID": clientId
                }
                ws.send(JSON.stringify(payLoad));
            }

        })

        btnStartGame.addEventListener("click", e => {

        })

        ws.onmessage = function (message) {
            const messageContents = JSON.parse(message.data);

            if (messageContents.method === "connect") {
                clientId = messageContents.clientId;
                console.log("client id obtained - " + clientId);

            }
            if (messageContents.method === "newGameResponse") {
                gameListLength = messageContents.gameListLength;
                console.log("response from new game recieved, " + gameListLength+messageContents.games.gameId);
//                buildGameList(games);
                var entry = document.createElement('button');
                entry.appendChild(document.createTextNode(gameListLength));
                gameList.append(entry);
            }
        }

        function buildGameList(games) {
            games.forEach(gameList.append(document.createElement('button').appendChild(document.createTextNode('1'))));
        }

    </script>
</body>
</html>